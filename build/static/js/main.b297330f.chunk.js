(this["webpackJsonppowerbi-embedded-sample"]=this["webpackJsonppowerbi-embedded-sample"]||[]).push([[0],{439:function(e,t,r){e.exports=r(822)},637:function(e,t,r){},822:function(e,t,r){"use strict";r.r(t);r(440),r(449),r(632);var n=r(0),o=r.n(n),a=r(87),c=r.n(a),s=r(53),i=r.n(s),u=r(89),l=r(92),d=r(93),p=r(119),f=r(118),m=r(860),h=r(94),v=(r(637),["https://analysis.windows.net/powerbi/api/Report.Read.All"]),b="b4d89c91-9284-45e7-92e1-3fd0f59cf20f",y="44d6556a-c8ca-451c-9f24-51ebfd04ab69",k=r(91),g=r(253),R=r(393);function w(e){return E.apply(this,arguments)}function E(){return(E=Object(u.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.bookmarksManager.capture();case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e.catch(0),console.log(e.t0);case 9:return e.abrupt("return",void 0);case 10:case"end":return e.stop()}}),e,null,[[0,6]])})))).apply(this,arguments)}function T(){return(T=Object(u.a)(i.a.mark((function e(t,r){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r.bookmarksManager.applyState(t);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})))).apply(this,arguments)}function x(e,t){var r=Object(g.initProvenance)(t);r.addGlobalObserver((function(){!function(e,t){T.apply(this,arguments)}(r.getState(r.current).bookmark,e)})),r.done();return function(){var e=document.getElementById("provDiv");e&&Object(R.ProvVisCreator)(e,r,(function(e){return r.goToNode(e)}),!0,!1,void 0)}(),{provenance:r,actions:{event:function(e,t,n){r.apply({apply:function(r){var o;return r.bookmark=e,null===(o=Array.from(t.entries()))||void 0===o||o.forEach((function(e){var t=Object(k.a)(e,2),n=t[0],o=t[1];return r.featureVector[n]=o})),{state:r,label:"Click on ".concat(n),stateSaveMode:"Complete",actionType:"Regular",eventType:"",meta:{}}}},"Click on ".concat(n))}}}}function S(e){var t=e.report,r=(e.models,o.a.useRef(new Map)),n=o.a.useState(null),a=Object(k.a)(n,2),c=a[0],s=a[1];return o.a.useEffect((function(){t.on("loaded",Object(u.a)(i.a.mark((function e(){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w(t);case 2:r=e.sent,s({featureVector:{Month:"",FPDesc:"",Region:"",Ethnicity:""},bookmark:(null===r||void 0===r?void 0:r.state)||""});case 4:case"end":return e.stop()}}),e)}))))}),[t]),o.a.useEffect((function(){if(c){var e=x(t,c).actions;t.on("dataSelected",function(){var n=Object(u.a)(i.a.mark((function n(o){var a,c,s,u;return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=o.detail.dataPoints,c=new Map,s="",a.length>0?a[0].identity.forEach((function(e){c.set(e.target.column,e.equals),s+=e.target.column+" "})):r.current.size>0?Array.from(r.current.keys()).forEach((function(e){c.set(e,""),s+=e+" "})):s+="none ",r.current=c,console.log("Data Selected",o.detail),n.next=8,w(t);case 8:(u=n.sent)&&e.event(u.state,c,s.slice(0,-1));case 10:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}())}}),[t,r,c]),o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{id:"provDiv",style:{width:300}}))}var j,O=new h.service.Service(h.factories.hpmFactory,h.factories.wpmpFactory,h.factories.routerFactory),U="",C="",A=function(e){Object(p.a)(r,e);var t=Object(f.a)(r);function r(e){var n;return Object(l.a)(this,r),(n=t.call(this,e)).myReport=void 0,n.state={accessToken:"",embedUrl:"",error:[],reportRef:o.a.createRef()},n.myReport=null,n}return Object(d.a)(r,[{key:"render",value:function(){return this.myReport=this.renderMyReport(),o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{style:{display:"flex"}},o.a.createElement("div",{id:"reportContainer",ref:this.state.reportRef,style:{display:"flex",flexDirection:"column",flex:1}},"Loading the report..."),this.myReport?o.a.createElement(S,{report:this.myReport,models:h.models}):null))}},{key:"componentDidMount",value:function(){var e=Object(u.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null!==this.state.reportRef&&(j=this.state.reportRef.current),this.authenticate();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"renderMyReport",value:function(){var e=null;if(this.state.error.length)j.textContent="",this.state.error.forEach((function(e){j.appendChild(document.createTextNode(e)),j.appendChild(document.createElement("br"))})),console.log("Error",this.state.error);else if(""!==this.state.accessToken&&""!==this.state.embedUrl){var t={type:"report",tokenType:h.models.TokenType.Aad,accessToken:U,embedUrl:C,permissions:h.models.Permissions.All,id:y,settings:{visualRenderedEvents:!0,panes:{filters:{visible:!0},pageNavigation:{visible:!0}}}};(e=O.embed(j,t)).off("loaded"),e.on("loaded",(function(){console.log("Report load successful")})),e.off("rendered"),e.on("rendered",(function(){console.log("Report render successful")})),e.off("error"),e.on("error",(function(e){var t=e.detail;console.error(t)}))}return e}},{key:"componentWillUnmount",value:function(){O.reset(j)}},{key:"authenticate",value:function(){var e=this,t=this,r={auth:{clientId:"8907c50f-2760-4f23-8310-0dd4b59a3d4e"}},n={scopes:v},o=new m.a(r);o.handleRedirectCallback((function(e){"id_token"===e.tokenType?t.authenticate():"access_token"===e.tokenType?(U=e.accessToken,t.setUsername(e.account.name),t.getembedUrl()):t.setState({error:["Token type is: "+e.tokenType]})}),(function(e){t.setState({error:["Redirect error: "+e]})})),o.getAccount()?o.acquireTokenSilent(n).then((function(t){U=t.accessToken,e.setUsername(t.account.name),e.getembedUrl()})).catch((function(e){"InteractionRequiredAuthError"===e.name?o.acquireTokenRedirect(n):t.setState({error:[e.toString()]})})):o.loginRedirect(n)}},{key:"getembedUrl",value:function(){var e=this;fetch("https://api.powerbi.com/v1.0/myorg/groups/"+b+"/reports/"+y,{headers:{Authorization:"Bearer "+U},method:"GET"}).then((function(t){var r=[];r.push("Error occurred while fetching the embed URL of the report"),r.push("Request Id: "+t.headers.get("requestId")),t.json().then((function(n){t.ok?(C=n.embedUrl,e.setState({accessToken:U,embedUrl:C})):(r.push("Error "+t.status+": "+n.error.code),e.setState({error:r}))})).catch((function(){r.push("Error "+t.status+":  An error has occurred"),e.setState({error:r})}))})).catch((function(t){e.setState({error:t})}))}},{key:"setUsername",value:function(e){var t=document.getElementById("welcome");null!==t&&(t.innerText="Welcome, "+e)}}]),r}(o.a.Component);c.a.render(o.a.createElement(A,null),document.getElementById("root"))}},[[439,1,2]]]);
//# sourceMappingURL=main.b297330f.chunk.js.map