{"version":3,"sources":["power-bi/Config.ts","utils/RadioButton.tsx","pages/BackgroundQuestionsPage.tsx","pages/DSGVOPage.tsx","utils/utils.ts","pages/LastPage.tsx","provenance/Provenance.ts","provenance/Provectories.ts","power-bi/ProvectoriesDashboard.tsx","pages/QuestionPage.tsx","pages/SatisfactionQuestionPage.tsx","utils/constants.tsx","App.tsx","index.tsx"],"names":["scopes","workspaceId","reportId","RadioButton","radioButtonId","title","selected","setSelected","htmlFor","replaceAll","type","className","onChange","name","id","autoComplete","checked","BackgroundQuestionsPage","age","gender","experience","confidence","setAge","setGender","setExperience","setConfidence","setShowNextButton","React","useEffect","length","min","max","value","e","target","valueAsNumber","role","aria-label","map","gen","key","label","num","String","FirstPage","showMore","setShowMore","confirmed","setConfirmed","href","onClick","exportData","visual","a","tries","result","models","ExportDataType","Summarized","console","error","toCamelCaseString","split","t","i","toUpperCase","slice","join","getVisualAttributeMapper","mapper","getCapabilities","capabilities","dataRoles","Promise","all","getDataFields","dataFields","d","idx","getDataFieldDisplayName","attribute","getCurrentVisuals","report","getPages","then","pages","filter","page","isActive","getVisuals","visuals","v","appStateToFeatureVector","currState","rootState","featureVector","selectedColumns","Set","filteredColumns","Object","keys","forEach","vKey","visState","rootVisState","aKey","rootAttribute","currAttribute","columnTitle","vector","push","root","includes","add","selectedValues","Array","from","filteredValues","LastPage","questionProvanencesRef","satisfaction","user","useState","downloaded","setDownloaded","uploadClicked","setUploadClicked","getCsvString","csvRows","current","sort","b","questionId","y","addCols","reduce","obj","vectors","provenance","graph","featureVectors","nodes","currNode","currVector","getState","newRow","metadata","createdOn","values","featureVectorizeGraph","exportFeatureVectorRows","csvString","row","cell","newString","JSON","stringify","featureVectorsToCsvString","uri","encodeURI","anchor","document","createElement","style","display","download","click","window","open","remove","downloadGraphAsFeatVecCsv","rel","setupProvenance","defaultState","initProvenance","done","event","onDashboardClick","newState","apply","state","stateSaveMode","actionType","eventType","meta","actions","setProvenance","newProvenance","Provectories","appState","this","init","dataPoints","detail","visDesc","selections","point","identity","column","equals","j","categoryMapper","data","groupedData","header","index","currSet","category","number","match","parseInt","currArr","initAppState","setVisState","getActivePage","activePage","on","setVisSelected","parse","log","powerbi","service","Service","factories","hpmFactory","wpmpFactory","routerFactory","ProvectoriesDashboard","reportRef","embedUrl","accessTokenRef","reportContainerRef","renderMyReport","embedConfiguration","tokenType","TokenType","Aad","accessToken","permissions","Permissions","All","config","settings","visualRenderedEvents","panes","filters","visible","pageNavigation","embed","off","provectories","errorMsg","Error","textContent","line","appendChild","createTextNode","container","reset","ref","height","QuestionPage","currentQuestion","setCurrentQuestion","reportLoaded","setReportLoaded","question","answerPossibilities","Number","toString","answerId","prev","mentalEffort","SatisfactionQuestionPage","setSatisfaction","EVALUATION_QUESTIONS","taskId","1","2","3","4","correctAnswerId","Math","random","item","USER","uuid","App","setError","setEmbedUrl","pageNumber","setPageNumber","showNextButton","disableNextButton","setDisableNExtButton","questionNumber","onNextPageButtonClick","resolve","setTimeout","_","omit","cloneDeep","endtime","Date","getTime","prevState","currentPage","getembedUrl","fetch","headers","method","response","errorMessage","get","json","body","ok","status","code","catch","authenticate","msalConfig","auth","clientId","loginRequest","msalInstance","UserAgentApplication","handleRedirectCallback","getAccount","acquireTokenSilent","err","acquireTokenRedirect","loginRedirect","disabled","width","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.3e5af732.chunk.js","sourcesContent":["// ----------------------------------------------------------------------------\n// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\n// ----------------------------------------------------------------------------\n\n/* eslint-disable @typescript-eslint/no-inferrable-types */\n\n// Scope of AAD app. Use the below configuration to use all the permissions provided in the AAD app through Azure portal.\n// Refer https://aka.ms/PowerBIPermissions for complete list of Power BI scopes\n// https://analysis.windows.net/powerbi/api/Report.Read.All\nexport const scopes: string[] = [\"https://analysis.windows.net/powerbi/api/Report.Read.All\"];\n\n// Client Id (Application Id) of the AAD app.\nexport const clientId: string = \"f1f98e67-aeb3-406c-a3f6-8c90654a8562\";\n\n// Id of the workspace where the report is hosted\nexport const workspaceId: string = \"0223b04f-f0a4-43c6-9dbe-e152236e6a5a\";\n\n// Id of the report to be embedded\nexport const reportId: string = \"7c8477cc-60dc-4edf-a9f0-71b6f1b575da\";","import * as React from \"react\";\n\nexport function RadioButton<T>({ radioButtonId, title, selected, setSelected }: { radioButtonId: T, title: string, selected: T, setSelected: (selected: T) => void }) {\n\tconst htmlFor = title.replaceAll(' ', '') + '-' + radioButtonId;\n\treturn <>\n\t\t<input\n\t\t\ttype=\"radio\"\n\t\t\tclassName=\"btn-check\"\n\t\t\tonChange={() => setSelected(radioButtonId)}\n\t\t\tname={htmlFor}\n\t\t\tid={htmlFor}\n\t\t\tautoComplete=\"off\"\n\t\t\tchecked={selected === radioButtonId}\n\t\t/>\n\t\t<label className=\"btn btn-outline-secondary\" htmlFor={htmlFor}>{title}</label>\n\t</>;\n}","import React from \"react\";\nimport { RadioButton } from \"../utils/RadioButton\";\n\nexport function BackgroundQuestionsPage({\n\tage,\n\tgender,\n\texperience,\n\tconfidence,\n\tsetAge,\n\tsetGender,\n\tsetExperience,\n\tsetConfidence,\n\tsetShowNextButton\n}: {\n\tage: number;\n\tgender: string;\n\texperience: string;\n\tconfidence: number;\n\tsetAge: (age: number) => void;\n\tsetGender: (gender: string) => void;\n\tsetExperience: (experience: string) => void;\n\tsetConfidence: (confidence: number) => void;\n\tsetShowNextButton: (showNextButton: boolean) => void;\n}) {\n\n\tReact.useEffect(() => {\n\t\tif (gender.length > 0 && age > 0 && ((confidence !== -1 && experience === 'Yes') || (experience === 'No'))) {\n\t\t\tsetShowNextButton(true);\n\t\t} else {\n\t\t\tsetShowNextButton(false);\n\t\t}\n\t\tif (experience === 'No') {\n\t\t\tsetConfidence(-1);\n\t\t}\n\t}, [\n\t\tgender,\n\t\tage,\n\t\tconfidence,\n\t\texperience,\n\t\tsetConfidence,\n\t\tsetShowNextButton\n\t]);\n\n\treturn <div>\n\t\t<h2 className=\"mb-4\">Demographic Information</h2>\n\t\t<div className=\"row my-3\">\n\t\t\t<div className=\"col-8\"><h5>Please indicate your age</h5></div>\n\t\t\t<div className=\"col-4\"><input type=\"number\" min=\"0\" max=\"100\" className=\"form-control\" value={age} onChange={(e) => setAge(e.target.valueAsNumber)} /></div>\n\t\t</div>\n\t\t<div className=\"row my-3\">\n\t\t\t<div className=\"col-8\"><h5>Please indicate your gender</h5></div>\n\t\t\t<div className=\"col-4\">\n\t\t\t\t<div className=\"btn-group w-100\" role=\"group\" aria-label=\"gender-radio-button-group\">\n\t\t\t\t\t{(['m', 'f', 'd'])\n\t\t\t\t\t\t.map((gen) => <RadioButton<string>\n\t\t\t\t\t\t\tkey={`gender-radio-button-${gen}`}\n\t\t\t\t\t\t\tradioButtonId={gen}\n\t\t\t\t\t\t\ttitle={gen}\n\t\t\t\t\t\t\tselected={gender}\n\t\t\t\t\t\t\tsetSelected={setGender}\n\t\t\t\t\t\t/>)\n\t\t\t\t\t}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div className=\"row my-3\">\n\t\t\t<div className=\"col-8\"><h5>Do you already have experience with Dashboards/Interactive Visual Analytics Tools?</h5></div>\n\t\t\t<div className=\"col-4\">\n\t\t\t\t<div className=\"btn-group w-100\" role=\"group\" aria-label=\"experience-radio-button-group\">\n\t\t\t\t\t{['Yes', 'No']\n\t\t\t\t\t\t.map((label) => <RadioButton<string>\n\t\t\t\t\t\t\tkey={`experience-radio-button-${label}`}\n\t\t\t\t\t\t\tradioButtonId={label}\n\t\t\t\t\t\t\ttitle={label}\n\t\t\t\t\t\t\tselected={experience}\n\t\t\t\t\t\t\tsetSelected={setExperience}\n\t\t\t\t\t\t/>)\n\t\t\t\t\t}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t{experience === 'Yes' ?\n\t\t\t<div className=\"row my-3\">\n\t\t\t\t<div className=\"col-8\"><h5>How would you rate your confidence in using Dashboards/Interactive Visual Analytics Tools?</h5></div>\n\t\t\t\t<div className=\"col-4\">\n\t\t\t\t\t<div className=\"btn-group w-100\" role=\"group\" aria-label=\"confidence-radio-button-group\">\n\t\t\t\t\t\t{[1, 2, 3, 4, 5, 6]\n\t\t\t\t\t\t\t.map((num) => <RadioButton<number>\n\t\t\t\t\t\t\t\tkey={`confidence-radio-button-${num}`}\n\t\t\t\t\t\t\t\tradioButtonId={num}\n\t\t\t\t\t\t\t\ttitle={String(num)}\n\t\t\t\t\t\t\t\tselected={confidence}\n\t\t\t\t\t\t\t\tsetSelected={setConfidence}\n\t\t\t\t\t\t\t/>)\n\t\t\t\t\t\t}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"d-flex justify-content-between text-muted\">\n\t\t\t\t\t\t<i>1 - very low confidence</i><i>6 - very high confidence</i>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div> : null}\n\t</div>\n}\n","import * as React from 'react';\n\nexport function FirstPage({\n\tsetShowNextButton\n}: {\n\tsetShowNextButton: (showNextButton: boolean) => void;\n}) {\n\tconst [showMore, setShowMore] = React.useState<boolean>(false);\n\tconst [confirmed, setConfirmed] = React.useState<boolean>(false);\n\n\treturn <div>\n\t\t<h2>Data Protection</h2>\n\t\t<b>\n\t\t\tWhy do we collect and process your data?\n\t\t</b>\n\t\t<p>\n\t\t\tThe study is a purely scientific study conducted by the LIT Robopsychology Lab and the Institute for\n\t\t\tComputer Graphics at the Johannes Kepler University Linz. The data will be used primarily to\n\t\t\tgenerate scientific insights. Any publication will be in anonymous form.\n\t\t</p>\n\t\t<p>\n\t\t\tParticipation in the study is entirely voluntary. You may withdraw your consent to participate at any\n\t\t\ttime and without giving any reason, without incurring any disadvantages.\n\t\t</p>\n\t\t<p>\n\t\t\tWith the declaration of participation below, you confirm that you have read the subject information and\n\t\t\tdata protection information and that you have understood the aim, procedure and implementation of the study,\n\t\t\tas well as the data protection regulations. In addition, by confirming the declaration of participation below,\n\t\t\tyou voluntarily agree to participate in the study and confirm that you are over 18 years of age.\n\t\t</p>\n\t\t<b>How can you contact us?</b>\n\t\t<p>\n\t\t\tThe responsible party for the procesing of the data described below within the meaning of Art 4 No. 7 GDPR is\n\t\t\tJohannes Kepler University Linz (JKU), Altenberger Straße 69, 4040 Linz, <a href=\"datenschutz@jku.at\">datenschutz@jku.at</a>.\n\t\t\tIf you have any questions about the study, please contact Thomas-Johann Schachinger, Johannes Kepler University Linz,\n\t\t\tAltenberger Straße 69, 4040 Linz, <a href=\"mailto:thomas.schachinger@icloud.com\">thomas.schachinger@icloud.com</a> or{' '}\n\t\t\t<a href=\"cg@jku.at\">cg@jku.at</a>.\n\t\t</p>\n\t\t<p>\n\t\t\tIf you would like more information about the processing of your personal data,{' '}\n\t\t\t<button className=\" btn btn-link pb-1 p-0\" type=\"button\" onClick={() => setShowMore(true)}>please click here</button>.\n\t\t</p>\n\n\t\t<div className=\"form-check mt-4 mb-5 ms-1\">\n\t\t\t<input\n\t\t\t\tclassName=\"form-check-input\"\n\t\t\t\ttype=\"checkbox\"\n\t\t\t\tid=\"flexCheckChecked\"\n\t\t\t\tchecked={confirmed}\n\t\t\t\tonChange={(e) => {\n\t\t\t\t\tsetConfirmed(e.target.checked);\n\t\t\t\t\tsetShowNextButton(true);\n\t\t\t\t}} />\n\t\t\t<label className=\"form-check-label\" htmlFor=\"flexCheckChecked\">\n\t\t\t\t<b>\n\t\t\t\t\tI consent to the processing of my personal data in accordance with the information provided here.\n\t\t\t\t</b>\n\t\t\t</label>\n\t\t</div>\n\t\t{!showMore ? null : <>\n\t\t\t<b>\n\t\t\t\tInformation on data processing\n\t\t\t</b>\n\t\t\t<b>\n\t\t\t\tHow long will the personal data be processed?\n\t\t\t</b>\n\t\t\t<p>\n\t\t\t\tThe data collected as part of the study will be recorded and statistically analyzed by an\n\t\t\t\telectronic data system. After completion of the study, all data will be stored and\n\t\t\t\tarchived according to the currently valid guidelines.\n\t\t\t\tThe fully anonymized data of this study can be made accessible as open data on the\n\t\t\t\tInternet in a data archive no later than five years after completion of the study.\n\t\t\t\tThus, this study follows the recommendations of the German Research Foundation (DFG)\n\t\t\t\tand the German Psychological Society (DGPs) for quality assurance in research.\n\t\t\t</p>\n\t\t\t<b>What personal data are collected and processed?</b>\n\t\t\t<p>\n\t\t\t\tAlthough information about you, including gender, age, and experience with visualization systems,\n\t\t\t\tis requested, due to the anonymity of the survey, you are not identifiable by this information.\n\t\t\t\tDirectly personal or personally identifiable data that allows conclusions to be drawn about your\n\t\t\t\tidentity is not collected.\n\t\t\t</p>\n\t\t\t<b>\n\t\t\t\tWhat special categories of personal data are collected and processed?\n\t\t\t</b>\n\t\t\t<p>\n\t\t\t\tNone\n\t\t\t</p>\n\t\t\t<b>\n\t\t\t\tLegal basis for processing\n\t\t\t</b>\n\t\t\t<p>\n\t\t\t\tProcessing is based on the consent of the data subject.\n\t\t\t</p>\n\t\t\t<b>\n\t\t\t\tData transfer to a country outside the EU/EEA or to an international organization,\n\t\t\t\tand data transfer subject to appropriate safeguards.\n\t\t\t</b>\n\t\t\t<p>\n\t\t\t\tThe anonymized data will be made available to the client of the study or to a body\n\t\t\t\tappointed by the client for scientific purposes or for the purpose of university teaching.\n\t\t\t\tThe anonymized data may also be made available to persons from non-EU member states in the\n\t\t\t\tcourse of international research collaborations.\n\t\t\t</p>\n\t\t\t<b>\n\t\t\t\tLegal or contractual requirement\n\t\t\t</b>\n\t\t\t<p>\n\t\t\t\tAny publication of research results is done anonymously. This ensures that it is impossible\n\t\t\t\tto draw conclusions about you as a person. Compliance with the Federal Data Protection Act is\n\t\t\t\tensured in full.\n\t\t\t</p>\n\t\t\t<b>\n\t\t\t\tAutomated procedure\n\t\t\t</b>\n\t\t\t<p>\n\t\t\t\tNo automated decision-making processes are carried out on the basis of personal data.\n\t\t\t</p>\n\t\t\t<b>\n\t\t\t\tInformation on the rights of data subjects\n\t\t\t</b>\n\t\t\t<p>\n\t\t\t\tSince no personal data is collected, once data collection is complete, it is no longer\n\t\t\t\tpossible to link the data in the data record to directly personal data (e.g., IP address) -\n\t\t\t\tthe data record is anonymous. This means that after completion of this data collection,\n\t\t\t\tit is no longer possible to specifically delete your personal data record, as it cannot be\n\t\t\t\tidentified.\n\t\t\t</p>\n\t\t\t<b>\n\t\t\t\tInformation about the right to withdraw consent\n\t\t\t</b>\n\t\t\t<p>\n\t\t\t\tParticipation in the study is entirely voluntary. You can withdraw your consent to\n\t\t\t\tparticipate at any time and without giving reasons, without incurring any disadvantages.\n\t\t\t\tThe processing of data prior to the withdrawal of consent remains lawful.\n\t\t\t</p>\n\t\t\t<b>\n\t\t\t\tData protection authority\n\t\t\t</b>\n\t\t\t<p>\n\t\t\t\tIn addition, data subjects may complain about what they consider to be unlawful data processing\n\t\t\t\tto the Austrian Data Protection Authority, Barichgasse 40-42, 1030 Vienna, Tel.: + 43 1 52 152-0, e-mail:\n\t\t\t\t<a href=\"dsb@dsb.gv.at\">dsb@dsb.gv.at</a>.\n\t\t\t</p>\n\t\t\t<b>\n\t\t\t\tOur data protection officer\n\t\t\t</b>\n\t\t\t<p>\n\t\t\t\tThe data protection officer within the meaning of Art 37 GDPR can be reached at Johannes Kepler University\n\t\t\t\tLinz (JKU), Data Protection Unit, Altenberger Straße 69, 4040 Linz, <a href=\"datenschutz@jku.at\">datenschutz@jku.at</a>.\n\t\t\t</p>\n\t\t</>}\n\t</div>\n}\n","import { Report } from \"report\";\nimport { IReportBookmark, IExportDataResult } from \"powerbi-models\";\nimport { models, VisualDescriptor } from \"powerbi-client\";\nimport 'powerbi-report-authoring';\nimport { IAppState, IExportFeatureVectorRow, IFeatureVector } from \"./interfaces\";\nimport { Provenance } from \"@visdesignlab/trrack\";\n\n/**\n * Captures and returns current bookmark\n * @param report Report to capture bookmark from\n */\nexport async function captureBookmark(report: Report): Promise<IReportBookmark | undefined> {\n\ttry {\n\t\treturn await report.bookmarksManager.capture();\n\t}\n\tcatch (error) {\n\t\tconsole.error(error);\n\t}\n\treturn undefined;\n}\n\n/**\n * Applies given bookmark on report\n * @param bookmark Bookmark to apply to\n * @param report Report to apply bookmark on\n */\nexport async function applyBookmark(bookmark: string, report: Report): Promise<void> {\n\ttry {\n\t\tawait report.bookmarksManager.applyState(bookmark);\n\t}\n\tcatch (error) {\n\t\tconsole.error(error);\n\t}\n}\n\n/**\n * Exports underlying data of given visual and handles errors\n * @param visual Visual to get underlying data from\n */\nexport async function exportData(visual: VisualDescriptor): Promise<IExportDataResult | null> {\n\t// starting on 12/16/2021, exportData throws error.\n\t// If call exportData repeatedly a few times then it starts to work.\n\t// Implement pattern to try 4 times before throwing an error\n\n\tlet tries = 0;\n\tlet result: models.IExportDataResult | null = null;\n\twhile (tries < 4) {\n\t\ttry {\n\t\t\tresult = await visual.exportData(models.ExportDataType.Summarized);\n\t\t\tbreak;\n\t\t} catch (err) {\n\t\t\ttries++;\n\t\t\tif (tries === 4) {\n\t\t\t\tconsole.error(('exportData - ' + visual.title), err);\n\t\t\t\t// console.error(`exportData [tries]: ${tries}`);\n\t\t\t}\n\t\t}\n\t}\n\treturn result;\n}\n\n/**\n * Create exact copy of object without referencing on it\n * @param obj Object to copy\n */\nexport function makeDeepCopy<T extends Object>(obj: T): T {\n\treturn typeof obj === 'object' ? JSON.parse(JSON.stringify(obj)) : obj;\n}\n\n/**\n * Takes string and returns multiple word string as one word camel case string\n * @param title String to be camel cased\n */\nexport function toCamelCaseString(title: string): string {\n\treturn title\n\t\t.split(' ')\n\t\t.map((t, i) => i === 0 ? t : t[0].toUpperCase() + t.slice(1))\n\t\t.join('');\n}\n\n/**\n * Categorizes columns of agiven visual to their attribute of the chart in a dict and returns it \n * @param visual \n */\nexport async function getVisualAttributeMapper(visual: VisualDescriptor): Promise<{ [key: string]: string }> {\n\t// const roleToAttributeMap = {\n\t// \t'Y': 'yAxis',\n\t// \t'Category': 'xAxis',\n\t// \t'Series': 'Legend',\n\t// \t'Values': 'Field'\n\t// };\n\n\tconst mapper: { [key: string]: string } = {};\n\tif (visual.getCapabilities) {\n\t\tconst capabilities = await visual.getCapabilities();\n\t\tif (capabilities.dataRoles) {\n\t\t\tawait Promise.all(capabilities.dataRoles.map(async (role) => {\n\t\t\t\tconst dataFields = await visual.getDataFields(role.name);\n\t\t\t\tif (dataFields.length > 0) {\n\t\t\t\t\tawait Promise.all(dataFields.map(async (d, idx) => {\n\t\t\t\t\t\tconst attribute = await visual.getDataFieldDisplayName(role.name, idx);\n\t\t\t\t\t\t// mapper[toCamelCaseString(attribute)] = roleToAttributeMap[role.name];\n\t\t\t\t\t\tmapper[toCamelCaseString(attribute)] = role.name;\n\t\t\t\t\t}));\n\t\t\t\t}\n\t\t\t}))\n\t\t}\n\t}\n\treturn mapper;\n}\n\n/**\n * Extracts current visuals from a dashboard of a report and returns them in an array\n * @param report Report to extract visuals from\n * Only possible if report is loaded\n */\nexport async function getCurrentVisuals(report: Report): Promise<VisualDescriptor[]> {\n\ttry {\n\t\treturn report\n\t\t\t.getPages().then(async (pages) => pages.filter((page) => page.isActive)[0]\n\t\t\t\t.getVisuals().then((visuals) => visuals\n\t\t\t\t\t.filter((v) => v.type !== 'card' && v.type !== 'shape' && v.type !== 'textbox')));\n\t} catch (err) {\n\t\tconsole.error(err);\n\t\treturn [];\n\t}\n}\n\n/**\n\t* Takes an appState and encodes it as a feature vector. Needs initial app state to know if an attribute is filtered\n\t* @param currState State to encode as a feature vector\n\t* @param rootState Initial app state\n\t*/\nexport function appStateToFeatureVector(currState: IAppState, rootState: IAppState): IFeatureVector {\n\tconst featureVector: IFeatureVector = {};\n\tconst selectedColumns = new Set<string>();\n\tconst filteredColumns = new Set<string>();\n\tObject.keys(rootState).forEach((vKey) => {\n\t\tconst { visState, selected, type } = currState[vKey];\n\t\tconst rootVisState = rootState[vKey].visState;\n\t\tObject.keys(rootVisState).forEach((aKey) => {\n\t\t\tconst rootAttribute = rootVisState[aKey];\n\t\t\tconst currAttribute = visState[aKey];\n\t\t\tlet columnTitle = vKey + '.' + aKey;\n\t\t\tconst vector = [] as number[];\n\t\t\t// number arrays will be used as they are\n\t\t\tif (typeof rootAttribute[0] === 'number') {\n\t\t\t\tcolumnTitle += \"<numerical>\";\n\t\t\t\tvector.push(...(currAttribute.length > 0 ? currAttribute as number[] : [0]));\n\t\t\t} else { // string arrays will be encoded\n\t\t\t\tcolumnTitle += \"<categorical>\";\n\t\t\t\t(rootAttribute as string[]).forEach((root) => {\n\t\t\t\t\tif (selected && selected[aKey]?.includes(root)) {// if selected 1 : 0\n\t\t\t\t\t\tvector.push(1);\n\t\t\t\t\t\tselectedColumns.add(columnTitle);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvector.push(0)\n\t\t\t\t\t}\n\t\t\t\t\tif (type !== 'slicer') { // slicers can't be filtered\n\t\t\t\t\t\tif ((currAttribute as string[]).includes(root)) { // if filtered then 1 (included = !filtered)\n\t\t\t\t\t\t\tvector.push(0);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvector.push(1);\n\t\t\t\t\t\t\tfilteredColumns.add(columnTitle);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\tfeatureVector[columnTitle] = vector;\n\t\t});\n\t});\n\n\treturn { selectedValues: Array.from(selectedColumns).join(\", \") || \"\", filteredValues: Array.from(filteredColumns).join(\", \") || \"\", ...featureVector };\n};\n\n/**\n * Goes through graph, returns feature vector row for each node and returns feature vector matrix\n * @param provenance Provenance object to featurize\n */\nexport function featureVectorizeGraph(provenance: Provenance<IAppState, string, void>, addCols: { [title: string]: string | number } = {}): IExportFeatureVectorRow[] {\n\tconst { root, graph } = provenance;\n\tconst featureVectors: IExportFeatureVectorRow[] = [];\n\n\tObject.keys(graph.nodes).forEach((key) => {\n\t\tconst currNode = graph.nodes[key];\n\t\tconst currVector = appStateToFeatureVector(\n\t\t\tprovenance.getState(currNode.id), provenance.getState(root.id)\n\t\t);\n\t\t// adding header row\n\t\tif (key === root.id) {\n\t\t\tfeatureVectors.push(['timestamp', ...Object.keys(addCols), 'triggeredAction', ...Object.keys(currVector)]);\n\t\t}\n\t\tconst newRow: IExportFeatureVectorRow = [currNode.metadata.createdOn || -1, ...Object.values(addCols), currNode.label];\n\t\t// skip first columns (that are not in the feature vector)\n\t\t(featureVectors[0] as string[]).slice(featureVectors[0].length - Object.keys(currVector).length).forEach((title) => newRow.push(currVector[title] ? currVector[title] : \"\"));\n\t\tfeatureVectors.push(newRow);\n\t});\n\treturn featureVectors;\n}\n\n/**\n * Takes feature vector matrix and converts it to a csv-string\n * @param exportFeatureVectorRows Feature vector matrix\n */\nexport function featureVectorsToCsvString(exportFeatureVectorRows: IExportFeatureVectorRow[]): string {\n\tlet csvString = 'data:text/csv;charset=utf-8,';\n\texportFeatureVectorRows.forEach((row, idx) => {\n\t\tif (idx === 0) {\n\t\t\tcsvString += row.join(';') + '\\r\\n';\n\t\t} else {\n\t\t\t(row as IExportFeatureVectorRow).forEach((cell, i) => {\n\t\t\t\tlet newString = typeof cell === \"string\" ? cell : JSON.stringify(cell);\n\t\t\t\t// removes brackets\n\t\t\t\tnewString = newString.replaceAll('[', '').replaceAll(']', '');\n\t\t\t\tcsvString += newString;\n\t\t\t\tcsvString += i < row.length - 1 ? ';' : '\\r\\n'\n\t\t\t});\n\t\t}\n\t});\n\treturn csvString;\n}\n","import React from \"react\";\nimport { IExportFeatureVectorRow, IProvenanceQuestion } from \"../utils/interfaces\";\nimport { featureVectorizeGraph, featureVectorsToCsvString } from \"../utils/utils\";\n\nexport function LastPage({\n\tquestionProvanencesRef,\n\tage,\n\tgender,\n\texperience,\n\tconfidence,\n\tsatisfaction,\n\tuser\n}: {\n\tquestionProvanencesRef: React.MutableRefObject<IProvenanceQuestion[]>\n\tage: number;\n\tgender: string;\n\texperience: string;\n\tconfidence: number;\n\tsatisfaction: number;\n\tuser: string;\n}) {\n\tconst [downloaded, setDownloaded] = React.useState<boolean>(false);\n\tconst [uploadClicked, setUploadClicked] = React.useState<boolean>(false);\n\n\tconst getCsvString = (): string => {\n\t\tconst csvRows: IExportFeatureVectorRow[] = [];\n\t\tquestionProvanencesRef.current.sort((a, b) => a.questionId - b.questionId).forEach((y, i) => {\n\t\t\tconst addCols = {\n\t\t\t\tuser,\n\t\t\t\tage,\n\t\t\t\tgender,\n\t\t\t\texperience: experience === 'Yes' ? 1 : 0,\n\t\t\t\tconfidence,\n\t\t\t\tsatisfaction,\n\t\t\t\t...Object.keys(y)\n\t\t\t\t\t.filter((key) => key !== \"provenance\")\n\t\t\t\t\t.reduce((obj, key) => ({ ...obj, [key]: y[key] }), {})\n\t\t\t};\n\t\t\tlet vectors: IExportFeatureVectorRow[] = featureVectorizeGraph(y.provenance, addCols);\n\t\t\tif (i > 0) {\n\t\t\t\tvectors = vectors.slice(1);\n\t\t\t}\n\t\t\tcsvRows.push(...vectors);\n\t\t});\n\t\treturn featureVectorsToCsvString(csvRows);\n\t}\n\n\tconst downloadGraphAsFeatVecCsv = (): void => {\n\t\tconst uri = encodeURI(getCsvString());\n\t\tconst anchor = document.createElement('a');\n\t\tanchor.style.display = 'none';\n\t\tif (\"download\" in anchor) {\n\t\t\tanchor.download = `provectories-${user}.csv`;\n\t\t\tanchor.href = uri;\n\t\t\tanchor.click();\n\t\t} else {\n\t\t\twindow.open(uri, '_self');\n\t\t}\n\t\tanchor.remove();\n\t};\n\n\treturn <div>\n\t\t<h2>Thank you for attending!</h2>\n\t\t<h4>To save your provenance status please click following button to download it as csv-file</h4>\n\t\t<button\n\t\t\tclassName=\"btn btn-secondary\"\n\t\t\ttype=\"button\"\n\t\t\tonClick={() => {\n\t\t\t\tdownloadGraphAsFeatVecCsv();\n\t\t\t\tsetDownloaded(true);\n\t\t\t}}\n\t\t>\n\t\t\tDownload CSV\n\t\t</button>\n\t\t{downloaded ? <>\n\t\t\t<h4>When downloaded please upload your created csv-file here:</h4>\n\t\t\t<a\n\t\t\t\thref=\"https://drive.google.com/drive/folders/1ZJAY7lLsvxNEv2QYFxpPi_8Pn7v4uv0n?usp=sharing\"\n\t\t\t\ttarget=\"_blank\"\n\t\t\t\trel=\"noopener noreferrer\"\n\t\t\t\tonClick={() => setUploadClicked(true)}\n\t\t\t>\n\t\t\t\thttps://drive.google.com/drive/folders/1ZJAY7lLsvxNEv2QYFxpPi_8Pn7v4uv0n?usp=sharing\n\t\t\t</a>\n\t\t</> : null}\n\t\t{uploadClicked ? <>\n\t\t\t<h3>Thank you!</h3>\n\t\t\t<p>To logout just close this window</p>\n\t\t</> : null}\n\t</div>\n}\n","import { Provenance, initProvenance } from '@visdesignlab/trrack';\nimport { IAppState } from '../utils/interfaces';\nimport { ActionReturnType } from '@visdesignlab/trrack/dist/Types/Action';\n\nexport interface IAction {\n  event: (onDashboardClick: () => Promise<{ newState: IAppState, label: string }>) => void;\n}\n\ninterface IAppProvenance {\n  provenance: Provenance<IAppState, string, void>;\n  actions: IAction;\n}\n\n/**\n * Initializes trrack and trrack-vis provenance\n * @param defaultState Initial state of the dashboard\n */\nexport function setupProvenance(defaultState: IAppState): IAppProvenance {\n  const provenance = initProvenance<IAppState, string, void>(defaultState as IAppState);\n\n  provenance.done();\n\n  const event = async (onDashboardClick: () => Promise<{ newState: IAppState, label: string }>) => {\n    const { newState, label } = await onDashboardClick();\n    provenance.apply({\n      apply: (state: IAppState) => ({\n        state: newState as IAppState,\n        label,\n        stateSaveMode: 'Complete',\n        actionType: 'Regular',\n        eventType: '',\n        meta: {}\n      } as ActionReturnType<IAppState, string>)\n    }, label);\n  };\n\n  return {\n    provenance,\n    actions: {\n      event\n    },\n  };\n}\n","import { Report } from \"report\";\nimport { setupProvenance } from \"./Provenance\";\nimport { IAppState } from \"../utils/interfaces\";\nimport { exportData, toCamelCaseString, getCurrentVisuals, makeDeepCopy, getVisualAttributeMapper } from \"../utils/utils\";\nimport { Provenance } from \"@visdesignlab/trrack\";\nimport 'powerbi-report-authoring';\n\nexport const provenance: Provenance<IAppState, string, void> = {} as Provenance<IAppState, string, void>;\n\nfunction setProvenance(newProvenance: Provenance<IAppState, string, void>) {\n\tObject.keys(newProvenance).forEach((key) => {\n\t\tprovenance[key] = newProvenance[key];\n\t});\n}\n\nclass Provectories {\n\tprivate readonly appState: IAppState;\n\tprivate readonly report: Report;\n\n\tconstructor(report: Report) {\n\t\tthis.appState = {};\n\t\tthis.report = report;\n\t\tthis.init();\n\t}\n\n\t/**\n\t * Sets the selected attribute of given visuals extracted from the click-event\n\t * Only possible if report is loaded\n\t * @param event click-event from dashboard eventlistener\n\t */\n\tsetVisSelected(event: any): string {\n\t\tconst { dataPoints } = event.detail;\n\t\tconst { type, title } = event.detail.visual;\n\t\tconst visuals = this.appState;\n\t\tlet label = `${title} (${type}) - `;\n\n\t\t// clears non slicer values when non slicer selection\n\t\tif (type !== 'slicer') {\n\t\t\tObject.keys(visuals).forEach((key) => {\n\t\t\t\tconst visDesc = visuals[key];\n\t\t\t\tvisDesc.selected = visDesc.type !== 'slicer' ? null : visDesc.selected;\n\t\t\t});\n\t\t}\n\t\t// asign selected values\n\t\tconst visDesc = visuals[toCamelCaseString(title)];\n\t\tif (dataPoints.length > 0) {\n\t\t\tconst selections: { [key: string]: string[] } = {};\n\n\t\t\tdataPoints.forEach((point: any) => {\n\t\t\t\tpoint.identity.forEach((i: any) => {\n\t\t\t\t\tselections[i.target.column] = [...(selections[i.target.column] ? selections[i.target.column] : []), i.equals];\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tObject.keys(selections).forEach((key, i) => {\n\t\t\t\tlabel += `${i > 0 ? '. ' : ''}${key}: `;\n\t\t\t\tvisDesc.selected = { ...visDesc.selected, [key]: Array.from(new Set(selections[key])) };\n\t\t\t\tselections[key].forEach((value, j) => {\n\t\t\t\t\tlabel += `${j > 0 ? ', ' : ''}${value}`;\n\t\t\t\t})\n\t\t\t})\n\t\t\treturn label + ' selected';\n\t\t}\n\t\tvisDesc.selected = null;\n\t\treturn label + 'deselected';\n\t};\n\n\t/**\n\t * Sets the current state of all visuals of the dashboard on given appState\n\t * Only possible if report is loaded\n\t * @param appState appState object of which the visuals should be set\n\t */\n\tasync setVisState(appState: IAppState): Promise<IAppState> {\n\t\tconst visuals = await getCurrentVisuals(this.report);\n\t\tawait Promise.all(visuals.map(async (v) => {\n\t\t\tconst result = await exportData(v);\n\t\t\tconst categoryMapper = await getVisualAttributeMapper(v);\n\t\t\tif (!result) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// vectorize data string && remove last row (empty)\n\t\t\tconst data = result.data.replaceAll(\"\\n\", \"\").split('\\r').map((d) => d.split(',')).slice(0, -1);\n\t\t\tconst groupedData: { [key: string]: any[] } = {};\n\n\t\t\t// group data columnwise\n\t\t\tdata[0].forEach((header, index) => {\n\t\t\t\tconst key = toCamelCaseString(header);\n\t\t\t\tgroupedData[key] = [];\n\t\t\t\tconst currSet = groupedData[key];\n\t\t\t\tconst category = categoryMapper[key];\n\n\t\t\t\tdata.forEach((row, idx) => {\n\t\t\t\t\t// skip headers and empty values\n\t\t\t\t\tif (idx === 0 || !row[index]) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tconst cell = row[index];\n\t\t\t\t\tconst number = cell.match(/\\d+/);\n\t\t\t\t\t// only add as number, when cell is not from a category column or legend\n\t\t\t\t\tconst value = number && category === 'Y' ? parseInt(number[0]) : cell;\n\t\t\t\t\tcurrSet.push(value);\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tconst { visState } = appState[toCamelCaseString(v.title)];\n\t\t\t// assign to visual state in right format\n\t\t\tObject.keys(groupedData).forEach((key) => {\n\t\t\t\tconst currArr: string[] | number[] = Array.from(groupedData[key]);\n\t\t\t\tvisState[key] = typeof currArr[0] === 'number' ?\n\t\t\t\t\t(currArr as number[]) : Array.from(new Set(currArr as string[]));\n\t\t\t});\n\t\t}));\n\t\treturn appState;\n\t};\n\n\t/**\t\n\t* Initialize appState\n\t* Only possible if report is loaded\n\t*/\n\tasync initAppState() {\n\t\tconst visuals = await getCurrentVisuals(this.report);\n\t\tvisuals.forEach((v) => {\n\t\t\tconst title = toCamelCaseString(v.title);\n\t\t\tif (this.appState && !this.appState[title]) {\n\t\t\t\tthis.appState[toCamelCaseString(title)] = { selected: null, type: v.type, visState: {} };\n\t\t\t}\n\t\t});\n\t};\n\n\t/**\n\t * initializes provenance, click-event handler and the appState\n\t */\n\tasync init(): Promise<void> {\n\t\tawait this.initAppState();\n\t\tconst appState = await this.setVisState(this.appState);\n\t\tconst { actions, provenance } = setupProvenance(appState);\n\n\t\tsetProvenance(provenance);\n\t\tconst activePage = (await this.report.getActivePage()).name;\n\n\t\tthis.report?.on(\"dataSelected\", async (event: any) => {\n\t\t\t// used closure to check if the current page equals the page provenance is initialized on\n\t\t\t// otherwise the provenance would make no sense for this case\n\t\t\tif (activePage === (await this.report.getActivePage()).name) {\n\t\t\t\tconst label = this.setVisSelected(event);\n\n\t\t\t\t// function call is done in provenance for better performance on the dashboard\n\t\t\t\tconst onDashboardClick = async () => {\n\t\t\t\t\tconst appState = await this.setVisState(makeDeepCopy(this.appState));\n\t\t\t\t\treturn { newState: appState, label };\n\t\t\t\t};\n\n\t\t\t\tactions.event(onDashboardClick);\n\t\t\t} else {\n\t\t\t\tconsole.log(\"Not on the tracked page\");\n\t\t\t}\n\t\t});\n\t};\n}\n\nexport function provectories(report: Report): void {\n\tnew Provectories(report);\n}","// ----------------------------------------------------------------------------\n// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\n// ----------------------------------------------------------------------------\n\nimport * as React from \"react\";\nimport { service, factories, models, IEmbedConfiguration, Report } from \"powerbi-client\";\nimport { provectories } from \"../provenance/Provectories\";\nimport * as config from \"./Config\";\n\nconst powerbi = new service.Service(factories.hpmFactory, factories.wpmpFactory, factories.routerFactory);\n\nexport function ProvectoriesDashboard({\n\tquestionId,\n\treportRef,\n\terror,\n\tembedUrl,\n\taccessTokenRef\n}: {\n\tquestionId: number;\n\treportRef: React.MutableRefObject<Report | undefined>;\n\tembedUrl: string;\n\terror: string[];\n\taccessTokenRef: React.MutableRefObject<string>;\n}) {\n\tconst reportContainerRef = React.useRef<HTMLDivElement>(null);\n\n\tconst renderMyReport = React.useCallback((): Report | undefined => {\n\t\tlet report: any | Report = null;\n\t\tif (error.length) {\n\t\t\t// Cleaning the report container contents and rendering the error message in multiple lines\n\t\t\treportContainerRef.current!.textContent = \"\";\n\t\t\terror.forEach(line => {\n\t\t\t\treportContainerRef.current!.appendChild(document.createTextNode(line));\n\t\t\t\treportContainerRef.current!.appendChild(document.createElement(\"br\"));\n\t\t\t});\n\t\t\tconsole.log('Error', error);\n\t\t} else if (accessTokenRef.current !== \"\" && embedUrl !== \"\") { // comment this condition\n\n\t\t\tconst embedConfiguration: IEmbedConfiguration = {\n\t\t\t\ttype: \"report\",\n\t\t\t\ttokenType: models.TokenType.Aad,\n\t\t\t\taccessToken: accessTokenRef.current,\n\t\t\t\tembedUrl,\n\t\t\t\tpermissions: models.Permissions.All,\n\t\t\t\tid: config.reportId,\n\t\t\t\tsettings: {\n\t\t\t\t\tvisualRenderedEvents: true,\n\t\t\t\t\tpanes: {\n\t\t\t\t\t\tfilters: {\n\t\t\t\t\t\t\tvisible: true\n\t\t\t\t\t\t},\n\t\t\t\t\t\tpageNavigation: {\n\t\t\t\t\t\t\tvisible: true\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tif (reportContainerRef.current) {\n\t\t\t\treport = powerbi.embed(reportContainerRef.current, embedConfiguration) as Report;\n\n\t\t\t\t// Clear any other loaded handler events\n\t\t\t\treport.off(\"loaded\");\n\n\t\t\t\t// Triggers when a content schema is successfully loaded\n\t\t\t\treport.on(\"loaded\", function () {\n\t\t\t\t\tconsole.log(\"Report load successful\");\n\t\t\t\t\t// init provectories\n\t\t\t\t\tprovectories(report);\n\t\t\t\t});\n\n\t\t\t\t// Clear any other error handler event\n\t\t\t\treport.off(\"error\");\n\n\t\t\t\t// Below patch of code is for handling errors that occur during embedding\n\t\t\t\treport.on(\"error\", function (event: any) {\n\t\t\t\t\tconst errorMsg = event.detail;\n\t\t\t\t\t// Use errorMsg variable to log error in any destination of choice\n\t\t\t\t\tconsole.error(errorMsg);\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn report;\n\t\t} else {\n\t\t\tthrow Error(\"No container for the report\");\n\t\t}\n\t}, [error, embedUrl, accessTokenRef, reportContainerRef]);\n\n\tReact.useEffect(() => {\n\t\treportRef.current = renderMyReport();\n\t\tconst container = reportContainerRef.current;\n\t\treturn () => {\n\t\t\tif (container) {\n\t\t\t\tpowerbi.reset(container);\n\t\t\t}\n\t\t}\n\t}, [renderMyReport, questionId, reportRef]);\n\n\treturn <div id=\"reportContainer\" className=\"d-flex mb-1\" ref={reportContainerRef} style={{ height: \"65vh\" }} >\n\t\tLoading the report...\n\t</div>;\n}","import { Report } from 'powerbi-client';\nimport * as React from 'react';\nimport { ProvectoriesDashboard } from '../power-bi/ProvectoriesDashboard';\nimport { ICurrentQuestion } from '../utils/interfaces';\nimport { RadioButton } from '../utils/RadioButton';\n\nexport function QuestionPage({\n\treportRef,\n\tembedUrl,\n\terror,\n\taccessTokenRef,\n\tcurrentQuestion,\n\tsetCurrentQuestion,\n\tsetShowNextButton,\n}: {\n\treportRef: React.MutableRefObject<Report | undefined>;\n\tembedUrl: string;\n\terror: string[];\n\taccessTokenRef: React.MutableRefObject<string>;\n\tcurrentQuestion: ICurrentQuestion;\n\tsetCurrentQuestion: React.Dispatch<React.SetStateAction<ICurrentQuestion | null>>;\n\tsetShowNextButton: (showNextButton: boolean) => void;\n}) {\n\tconst [reportLoaded, setReportLoaded] = React.useState<boolean>(false);\n\n\tReact.useEffect(() => {\n\t\tsetReportLoaded(false)\n\t\treportRef.current?.on(\"rendered\", () => {\n\t\t\tsetReportLoaded(true);\n\t\t\treportRef.current?.off(\"rendered\");\n\t\t})\n\t}, [currentQuestion.questionId, reportRef]);\n\n\treturn <div className=\"ms-2\">\n\t\t<div className=\"my-3\">\n\t\t\t<ProvectoriesDashboard\n\t\t\t\treportRef={reportRef}\n\t\t\t\taccessTokenRef={accessTokenRef}\n\t\t\t\tembedUrl={embedUrl}\n\t\t\t\terror={error}\n\t\t\t\tquestionId={currentQuestion.questionId}\n\t\t\t/>\n\t\t</div>\n\t\t<div>\n\t\t\t<div className=\"row\">\n\t\t\t\t<div className=\"col-6\">\n\t\t\t\t\t<h5>{currentQuestion.question}</h5>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"col-6\">\n\t\t\t\t\t<div className=\"btn-group w-100\" role=\"group\" aria-label=\"evaluation-answer-radio-button-group\">\n\t\t\t\t\t\t{reportLoaded ? Object.keys(currentQuestion.answerPossibilities)\n\t\t\t\t\t\t\t.map((key) => <RadioButton<number>\n\t\t\t\t\t\t\t\tkey={`evaluation-answer-${currentQuestion.questionId}-${key}`}\n\t\t\t\t\t\t\t\tradioButtonId={Number(key)}\n\t\t\t\t\t\t\t\ttitle={currentQuestion.answerPossibilities[key].toString()}\n\t\t\t\t\t\t\t\tselected={currentQuestion.answerId}\n\t\t\t\t\t\t\t\tsetSelected={(answerId: number) => setCurrentQuestion((prev) => ({ ...prev as ICurrentQuestion, answerId }))}\n\t\t\t\t\t\t\t/>)\n\t\t\t\t\t\t\t: null}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t{currentQuestion.answerId !== -1 ? <div className=\"mt-3 row\">\n\t\t\t\t<div className=\"col-6\">\n\t\t\t\t\t<h5>How high would you rate the amount of mental effort invested for completing this task?</h5>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"col-6\">\n\t\t\t\t\t<div className=\"btn-group w-100\" role=\"group\" aria-label=\"mental-effort-radio-button-group\">\n\t\t\t\t\t\t{[1, 2, 3, 4, 5, 6]\n\t\t\t\t\t\t\t.map((num) => <RadioButton<number>\n\t\t\t\t\t\t\t\tkey={`mental-effort-radio-button-${num}`}\n\t\t\t\t\t\t\t\tradioButtonId={num}\n\t\t\t\t\t\t\t\ttitle={num.toString()}\n\t\t\t\t\t\t\t\tselected={currentQuestion.mentalEffort}\n\t\t\t\t\t\t\t\tsetSelected={(mentalEffort: number) => {\n\t\t\t\t\t\t\t\t\tsetCurrentQuestion((prev) => ({ ...prev as ICurrentQuestion, mentalEffort }));\n\t\t\t\t\t\t\t\t\tsetShowNextButton(true);\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t/>)\n\t\t\t\t\t\t}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"d-flex justify-content-between text-muted\">\n\t\t\t\t\t\t<i>1 - very low mental effort</i><i>6 - very high mental efford</i>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div> : null}\n\t\t</div>\n\t</div >\n}\n","import React from \"react\";\nimport { RadioButton } from \"../utils/RadioButton\";\n\nexport function SatisfactionQuestionPage({\n\tsatisfaction,\n\tsetSatisfaction,\n\tsetShowNextButton\n}: {\n\tsatisfaction: number;\n\tsetSatisfaction: (satisfaction: number) => void;\n\tsetShowNextButton: (showNextButton: boolean) => void;\n}) {\n\n\tReact.useEffect(() => {\n\t\tif (satisfaction > -1) {\n\t\t\tsetShowNextButton(true);\n\t\t}\n\t}, [satisfaction, setShowNextButton]);\n\n\treturn <div>\n\t\t<h3 className=\"mb-4\">User Experience</h3>\n\t\t<div className=\"row my-3\">\n\t\t\t<div className=\"row mb-3\">\n\t\t\t\t<h4>How satisfied are you with of your experience of information retrieval based on the previous used dashboard?</h4>\n\t\t\t</div>\n\t\t\t<div className=\"row w-75\">\n\t\t\t\t<div className=\"btn-group w-100\" role=\"group\" aria-label=\"satisfaction-radio-button-group\">\n\t\t\t\t\t{[1, 2, 3, 4, 5, 6]\n\t\t\t\t\t\t.map((num) => <RadioButton<number>\n\t\t\t\t\t\t\tkey={`satisfaction-radio-button-${num}`}\n\t\t\t\t\t\t\tradioButtonId={num}\n\t\t\t\t\t\t\ttitle={String(num)}\n\t\t\t\t\t\t\tselected={satisfaction}\n\t\t\t\t\t\t\tsetSelected={setSatisfaction}\n\t\t\t\t\t\t/>)\n\t\t\t\t\t}\n\t\t\t\t</div>\n\t\t\t\t<div className=\"d-flex justify-content-between text-muted\">\n\t\t\t\t\t<i>1 - very low satisfaction</i><i>6 - very high satisfaction</i>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n}\n","import { IEvaluationQuestion } from \"./interfaces\";\n\nconst randomEvaluationQuestions: IEvaluationQuestion[] = [\n\t{\n\t\tquestionId: 1,\n\t\ttaskId: 1,\n\t\tquestion: 'In which month of 2014 the most Group A employees were hired in the Northwest region?',\n\t\tanswerPossibilities: { 1: 'October', 2: 'July', 3: 'September', 4: 'December' },\n\t\tcorrectAnswerId: 2\n\t},\n\t{\n\t\tquestionId: 2,\n\t\ttaskId: 1,\n\t\tquestion: 'How many part-time employees did region East hire in 2014?',\n\t\tanswerPossibilities: { 1: '1021', 2: '905', 3: '1749', 4: '313' },\n\t\tcorrectAnswerId: 1\n\t},\n\t{\n\t\tquestionId: 3,\n\t\ttaskId: 2,\n\t\tquestion: 'Were more Group F employees hired in 2012 or in 2013?',\n\t\tanswerPossibilities: { 1: 2012, 2: 2013 },\n\t\tcorrectAnswerId: 2\n\t},\n\t{\n\t\tquestionId: 4,\n\t\ttaskId: 2,\n\t\tquestion: 'In which month, in either 2012 or 2014, most employees were hired in the Northwest? Answer with month and year.',\n\t\tanswerPossibilities: { 1: 'Oct 2014', 2: 'Nov 2012', 3: 'Jul 2014', 4: 'Jun 2014' },\n\t\tcorrectAnswerId: 3\n\t},\n\t{\n\t\tquestionId: 5,\n\t\ttaskId: 3,\n\t\tquestion: 'How many new Group B hires in the East region happened in the range from January to June in 2012?',\n\t\tanswerPossibilities: { 1: 22, 2: 69, 3: 18, 4: 6 },\n\t\tcorrectAnswerId: 1\n\t},\n\t{\n\t\tquestionId: 6,\n\t\ttaskId: 3,\n\t\tquestion: 'How many employees of all ethnicities except Group A did region South hire in 2013?',\n\t\tanswerPossibilities: { 1: 768, 2: 422, 3: 802, 4: 565 },\n\t\tcorrectAnswerId: 1\n\t}\n];\n\nconst lastEvaluationQuestions: IEvaluationQuestion[] = [\n\t{\n\t\tquestionId: 7,\n\t\ttaskId: 4,\n\t\tquestion: 'Across all years, which month had the most part-time hires? Answer with month and year.',\n\t\tanswerPossibilities: { 1: 'Oct 2013', 2: 'Jun 2014', 3: 'Nov 2012', 4: 'Sept 2014' },\n\t\tcorrectAnswerId: 4\n\t},\n\t{\n\t\tquestionId: 8,\n\t\ttaskId: 4,\n\t\tquestion: 'Which region had at least one month with a lower number of new hires in 2012 than in 2011?',\n\t\tanswerPossibilities: { 1: 'West', 2: 'South', 3: 'Northwest', 4: 'East' },\n\t\tcorrectAnswerId: 2\n\t}\n]\n\nexport const EVALUATION_QUESTIONS: { [page: number]: IEvaluationQuestion } = [\n\t...randomEvaluationQuestions.sort((a, b) => 0.5 - Math.random()),\n\t...lastEvaluationQuestions\n].reduce((obj, item, idx) => ({ ...obj, [idx + 1]: item }), {});\n","import * as React from \"react\";\nimport { UserAgentApplication, AuthError, AuthResponse } from \"msal\";\nimport { v4 as uuid } from 'uuid';\nimport * as config from \"./power-bi/Config\";\nimport { BackgroundQuestionsPage } from \"./pages/BackgroundQuestionsPage\";\nimport { FirstPage } from \"./pages/DSGVOPage\";\nimport { LastPage } from \"./pages/LastPage\";\nimport { QuestionPage } from \"./pages/QuestionPage\";\nimport { SatisfactionQuestionPage } from \"./pages/SatisfactionQuestionPage\";\nimport { EVALUATION_QUESTIONS } from \"./utils/constants\";\nimport { Report } from \"powerbi-client\";\nimport { provenance } from \"./provenance/Provectories\";\nimport { ICurrentQuestion, IProvenanceQuestion } from \"./utils/interfaces\";\nimport _ from \"lodash\";\n\nconst USER: string = uuid();\n\nexport function App() {\n\tconst [age, setAge] = React.useState<number>(0);\n\tconst [error, setError] = React.useState<string[]>([]);\n\tconst [gender, setGender] = React.useState<string>('')\n\tconst [embedUrl, setEmbedUrl] = React.useState<string>('');\n\tconst [experience, setExperience] = React.useState<string>('');\n\tconst [confidence, setConfidence] = React.useState<number>(-1);\n\tconst [pageNumber, setPageNumber] = React.useState<number>(0);\n\tconst [satisfaction, setSatisfaction] = React.useState<number>(-1);\n\tconst [showNextButton, setShowNextButton] = React.useState<boolean>(false);\n\tconst [currentQuestion, setCurrentQuestion] = React.useState<ICurrentQuestion | null>(null);\n\tconst [disableNextButton, setDisableNExtButton] = React.useState<boolean>(false);\n\tconst questionProvanencesRef = React.useRef<IProvenanceQuestion[]>([]);\n\tconst accessTokenRef = React.useRef<string>('');\n\tconst questionNumber = pageNumber - 1; // adjust when new pages are added\n\tconst reportRef = React.useRef<Report>();\n\n\tconst onNextPageButtonClick = async () => {\n\t\tsetDisableNExtButton(true);\n\t\t// only set in question pages\n\t\tif (currentQuestion) {\n\t\t\t// wait for background async provenance track calls to be finished\n\t\t\tawait new Promise((resolve) => {\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tquestionProvanencesRef.current.push({\n\t\t\t\t\t\t...(_.omit(currentQuestion, ['answerPossibilities', 'question'])),\n\t\t\t\t\t\tprovenance: _.cloneDeep(provenance),\n\t\t\t\t\t\tendtime: new Date().getTime()\n\t\t\t\t\t});\n\t\t\t\t\tresolve(-1);\n\t\t\t\t}, 1500);\n\t\t\t});\n\t\t}\n\t\tsetShowNextButton(false);\n\t\tsetDisableNExtButton(false);\n\t\tsetPageNumber((prevState) => prevState + 1);\n\t};\n\n\tReact.useEffect(() => {\n\t\tsetCurrentQuestion(\n\t\t\tEVALUATION_QUESTIONS[questionNumber] ?\n\t\t\t\t{ ...EVALUATION_QUESTIONS[questionNumber], mentalEffort: -1, answerId: -1 } :\n\t\t\t\tnull\n\t\t);\n\t}, [questionNumber]);\n\n\tconst currentPage: React.ReactNode = React.useMemo<React.ReactNode>(() => {\n\t\tswitch (pageNumber) {\n\t\t\tcase 0:\n\t\t\t\treturn <FirstPage setShowNextButton={setShowNextButton} />;\n\t\t\tcase 1:\n\t\t\t\treturn <BackgroundQuestionsPage\n\t\t\t\t\tage={age}\n\t\t\t\t\tgender={gender}\n\t\t\t\t\texperience={experience}\n\t\t\t\t\tconfidence={confidence}\n\t\t\t\t\tsetShowNextButton={setShowNextButton}\n\t\t\t\t\tsetExperience={setExperience}\n\t\t\t\t\tsetConfidence={setConfidence}\n\t\t\t\t\tsetGender={setGender}\n\t\t\t\t\tsetAge={setAge}\n\t\t\t\t/>;\n\t\t\tcase 2: case 3: case 4: case 5: case 6: case 7: case 8: case 9:\n\t\t\t\treturn currentQuestion ?\n\t\t\t\t\t<QuestionPage\n\t\t\t\t\t\terror={error}\n\t\t\t\t\t\tembedUrl={embedUrl}\n\t\t\t\t\t\treportRef={reportRef}\n\t\t\t\t\t\taccessTokenRef={accessTokenRef}\n\t\t\t\t\t\tcurrentQuestion={currentQuestion}\n\t\t\t\t\t\tsetCurrentQuestion={setCurrentQuestion}\n\t\t\t\t\t\tsetShowNextButton={setShowNextButton}\n\t\t\t\t\t/> : <p>Invalid question number</p>;\n\t\t\tcase 10:\n\t\t\t\treturn <SatisfactionQuestionPage\n\t\t\t\t\tsatisfaction={satisfaction}\n\t\t\t\t\tsetSatisfaction={setSatisfaction}\n\t\t\t\t\tsetShowNextButton={setShowNextButton}\n\t\t\t\t/>;\n\t\t\tcase 11:\n\t\t\t\treturn <LastPage\n\t\t\t\t\tage={age}\n\t\t\t\t\tuser={USER}\n\t\t\t\t\tgender={gender}\n\t\t\t\t\texperience={experience}\n\t\t\t\t\tconfidence={confidence}\n\t\t\t\t\tsatisfaction={satisfaction}\n\t\t\t\t\tquestionProvanencesRef={questionProvanencesRef}\n\t\t\t\t/>\n\t\t\tdefault:\n\t\t\t\treturn <p>Invalid page number!</p>\n\t\t}\n\t}, [\n\t\tage,\n\t\terror,\n\t\tgender,\n\t\tembedUrl,\n\t\texperience,\n\t\tconfidence,\n\t\tpageNumber,\n\t\tsatisfaction,\n\t\tcurrentQuestion,\n\t\tsetCurrentQuestion,\n\t\tsetShowNextButton,\n\t\tsetSatisfaction,\n\t\tsetConfidence,\n\t\tsetExperience,\n\t\tsetGender,\n\t\tsetAge,\n\t]);\n\n\t// Power BI REST API call to get the embed URL of the report\n\tconst getembedUrl = React.useCallback(() => {\n\t\tfetch(\"https://api.powerbi.com/v1.0/myorg/groups/\" + config.workspaceId + \"/reports/\" + config.reportId, {\n\t\t\theaders: {\n\t\t\t\t\"Authorization\": \"Bearer \" + accessTokenRef.current\n\t\t\t},\n\t\t\tmethod: \"GET\"\n\t\t})\n\t\t\t.then(function (response) {\n\t\t\t\tconst errorMessage: string[] = [];\n\t\t\t\terrorMessage.push(\"Error occurred while fetching the embed URL of the report\")\n\t\t\t\terrorMessage.push(\"Request Id: \" + response.headers.get(\"requestId\"));\n\n\t\t\t\tresponse.json()\n\t\t\t\t\t.then((body) => {\n\t\t\t\t\t\t// Successful response\n\t\t\t\t\t\tif (response.ok) {\n\t\t\t\t\t\t\t// setAccessToken(accessToken);\n\t\t\t\t\t\t\tsetEmbedUrl(body[\"embedUrl\"]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// If error message is available\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\terrorMessage.push(\"Error \" + response.status + \": \" + body.error.code);\n\t\t\t\t\t\t\tsetError(errorMessage);\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t.catch(function () {\n\t\t\t\t\t\terrorMessage.push(\"Error \" + response.status + \":  An error has occurred\");\n\t\t\t\t\t\tsetError(errorMessage);\n\t\t\t\t\t});\n\t\t\t})\n\t\t\t.catch(function (error) {\n\t\t\t\t// Error in making the API call\n\t\t\t\tsetError(error);\n\t\t\t});\n\t}, [accessTokenRef]);\n\n\tconst authenticate = React.useCallback(() => {\n\t\tconst msalConfig = {\n\t\t\tauth: {\n\t\t\t\tclientId: config.clientId\n\t\t\t}\n\t\t};\n\n\t\tconst loginRequest = {\n\t\t\tscopes: config.scopes\n\t\t};\n\n\t\tconst msalInstance: UserAgentApplication = new UserAgentApplication(msalConfig);\n\n\t\tconst successCallback = (response: AuthResponse) => {\n\n\t\t\tif (response.tokenType === \"id_token\") {\n\t\t\t\tauthenticate();\n\t\t\t} else if (response.tokenType === \"access_token\") {\n\t\t\t\taccessTokenRef.current = response.accessToken;\n\t\t\t\tgetembedUrl();\n\t\t\t} else {\n\t\t\t\tsetError([(\"Token type is: \" + response.tokenType)])\n\t\t\t}\n\t\t}\n\n\t\tconst failCallBack = (error: AuthError) => {\n\t\t\tsetError([\"Redirect error: \" + error]);\n\t\t};\n\n\t\tmsalInstance.handleRedirectCallback(successCallback, failCallBack);\n\n\t\t// check if there is a cached user\n\t\tif (msalInstance.getAccount()) {\n\t\t\t// get access token silently from cached id-token\n\t\t\tmsalInstance.acquireTokenSilent(loginRequest)\n\t\t\t\t.then((response: AuthResponse) => {\n\t\t\t\t\t// get access token from response: response.accessToken\n\t\t\t\t\taccessTokenRef.current = response.accessToken;\n\t\t\t\t\tgetembedUrl();\n\t\t\t\t})\n\t\t\t\t.catch((err: AuthError) => {\n\n\t\t\t\t\t// refresh access token silently from cached id-token\n\t\t\t\t\t// makes the call to handleredirectcallback\n\t\t\t\t\tif (err.name === \"InteractionRequiredAuthError\") {\n\t\t\t\t\t\tmsalInstance.acquireTokenRedirect(loginRequest);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tsetError([err.toString()]);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t} else {\n\t\t\t// user is not logged in or cached, you will need to log them in to acquire a token\n\t\t\tmsalInstance.loginRedirect(loginRequest);\n\t\t}\n\t}, [getembedUrl]);\n\n\tReact.useEffect(() => {\n\t\t// User input - null check\n\t\tif (config.workspaceId === \"\" || config.reportId === \"\") {\n\t\t\tsetError([\"Please assign values to workspace Id and report Id in Config.ts file\"]);\n\t\t} else {\n\t\t\t// Authenticate the user and generate the access token\n\t\t\tauthenticate();\n\t\t}\n\t}, [authenticate]);\n\n\treturn (\n\t\t<div className=\"d-flex flex-column\">\n\t\t\t<div >\n\t\t\t\t<h2 id=\"title\" className=\"m-0 p-1\">\n\t\t\t\t\tProvectories: New Hires Example\n\t\t\t\t</h2>\n\t\t\t</div>\n\t\t\t<div className=\"card m-1 overflow-auto\" style={{ height: '88vh' }}>\n\t\t\t\t<div className=\"card-body\">\n\t\t\t\t\t{currentPage}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div className=\"d-flex justify-content-between mx-1\">\n\t\t\t\t<p className=\"text-muted\">{\n\t\t\t\t\tcurrentQuestion ? `Question ${questionNumber}/8` : null\n\t\t\t\t}</p>\n\t\t\t\t{showNextButton ?\n\t\t\t\t\t<button\n\t\t\t\t\t\tclassName=\"btn btn-primary\"\n\t\t\t\t\t\tonClick={() => onNextPageButtonClick()}\n\t\t\t\t\t\tdisabled={disableNextButton}\n\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\tstyle={{ width: '12vh' }}\n\t\t\t\t\t>\n\t\t\t\t\t\t{disableNextButton ? 'Loading...' : 'Next'}\n\t\t\t\t\t</button>\n\t\t\t\t\t: null}\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n","// ----------------------------------------------------------------------------\n// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\n// ----------------------------------------------------------------------------\n\nimport 'react-app-polyfill/ie11';\nimport 'react-app-polyfill/stable';\nimport 'semantic-ui-css/semantic.min.css'\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport { App } from './App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}