(this["webpackJsonppowerbi-embedded-sample"]=this["webpackJsonppowerbi-embedded-sample"]||[]).push([[0],{442:function(e,t,r){e.exports=r(827)},640:function(e,t,r){},827:function(e,t,r){"use strict";r.r(t);r(443),r(452),r(635);var n=r(0),a=r.n(n),c=r(89),o=r.n(c),u=r(18),s=r.n(u),i=r(33),p=r(92),l=r(93),f=r(119),d=r(118),h=r(864),v=r(70),m=(r(640),["https://analysis.windows.net/powerbi/api/Report.Read.All"]),b="ee69ff6f-a178-4528-81f3-c48716951cc6",y="c5c7899e-52df-4a76-962f-8fd0c3537480",k=r(192),x=r(260),w=r(255),g=r(396);r(197),r(822);function j(e){return O.apply(this,arguments)}function O(){return(O=Object(i.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.bookmarksManager.capture();case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e.catch(0),console.error(e.t0);case 9:return e.abrupt("return",void 0);case 10:case"end":return e.stop()}}),e,null,[[0,6]])})))).apply(this,arguments)}function S(){return(S=Object(i.a)(s.a.mark((function e(t,r){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r.bookmarksManager.applyState(t);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})))).apply(this,arguments)}function E(e){return R.apply(this,arguments)}function R(){return(R=Object(i.a)(s.a.mark((function e(t){var r,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=0,n=null;case 2:if(!(r<4)){e.next=16;break}return e.prev=3,e.next=6,t.exportData(v.models.ExportDataType.Summarized);case 6:return n=e.sent,e.abrupt("break",16);case 10:e.prev=10,e.t0=e.catch(3),4===++r&&console.error("exportData",e.t0);case 14:e.next=2;break;case 16:return e.abrupt("return",n);case 17:case"end":return e.stop()}}),e,null,[[3,10]])})))).apply(this,arguments)}function T(e){return e.split(" ").map((function(e,t){return 0===t?e:e[0].toUpperCase()+e.slice(1)})).join("")}function U(e){return C.apply(this,arguments)}function C(){return(C=Object(i.a)(s.a.mark((function e(t){var r,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r={},!t.getCapabilities){e.next=8;break}return e.next=4,t.getCapabilities();case 4:if(!(n=e.sent).dataRoles){e.next=8;break}return e.next=8,Promise.all(n.dataRoles.map(function(){var e=Object(i.a)(s.a.mark((function e(n){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getDataFields(n.name);case 2:if(!((a=e.sent).length>0)){e.next=6;break}return e.next=6,Promise.all(a.map(function(){var e=Object(i.a)(s.a.mark((function e(a,c){var o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getDataFieldDisplayName(n.name,c);case 2:o=e.sent,r[T(o)]=n.name;case 4:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 8:return e.abrupt("return",r);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function A(e){return D.apply(this,arguments)}function D(){return(D=Object(i.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.abrupt("return",t.getPages().then(function(){var e=Object(i.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t[1].getVisuals().then((function(e){return e.filter((function(e){return"card"!==e.type&&"shape"!==e.type}))})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 4:return e.prev=4,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",[]);case 8:case"end":return e.stop()}}),e,null,[[0,4]])})))).apply(this,arguments)}function I(e,t,r){var n=Object(w.initProvenance)(t);n.addGlobalObserver((function(){var t=n.getState(n.current);r.current!==t.bookmark&&(!function(e,t){S.apply(this,arguments)}(n.getState(n.current).bookmark,e),r.current="")})),console.log("provenance"),n.done();var a=function(){var e=Object(i.a)(s.a.mark((function e(t){var r,a,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t();case 2:r=e.sent,a=r.newState,c=r.label,n.apply({apply:function(e){return{state:a,label:c,stateSaveMode:"Complete",actionType:"Regular",eventType:"",meta:{}}}},c);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return function(){var e=document.getElementById("provDiv");e&&Object(g.ProvVisCreator)(e,n,(function(e){return n.goToNode(e)}),!0,!1,void 0,{height:500,width:150,textSize:12,verticalSpace:25})}(),{provenance:n,actions:{event:a}}}var P,q={},F={current:""},M=function(){var e=Object(i.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A(t);case 2:e.sent.forEach((function(e){var t=T(e.title);q.current&&!q.current[t]&&(q.current[T(t)]={selected:null,type:e.type,visState:{}})}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),N=function(e){var t=e.detail.dataPoints,r=e.detail.visual,n=r.type,a=r.title,c=q.current,o=a+" - ";if("slicer"!==n&&Object.keys(c).forEach((function(e){var t=c[e];t.selected="slicer"!==t.type?null:t.selected})),t.length>0){var u=c[T(a)];return t[0].identity.forEach((function(e,t){u.selected=Object(x.a)(Object(x.a)({},u.selected),{},Object(k.a)({},e.target.column,e.equals)),o+="".concat(t>0?"; ":"").concat(e.target.column,": ").concat(e.equals)})),o}return o+"deselected"},B=function(){var e=Object(i.a)(s.a.mark((function e(t,r){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A(r);case 2:return n=e.sent,e.next=5,Promise.all(n.map(function(){var e=Object(i.a)(s.a.mark((function e(r){var n,a,c,o,u;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E(r);case 2:return n=e.sent,e.next=5,U(r);case 5:if(a=e.sent,n){e.next=8;break}return e.abrupt("return");case 8:c=n.data.replaceAll("\n","").split("\r").map((function(e){return e.split(",")})).slice(0,-1),o={},c[0].forEach((function(e,t){var r=T(e);o[r]=[];var n=o[r],u=a[r];c.forEach((function(e,r){if(0!==r&&e[t]){var a=e[t],c=a.match(/\d+/),o=c&&"Y"===u?parseInt(c[0]):a;n.push(o)}}))})),u=t[T(r.title)].visState,Object.keys(o).forEach((function(e){var t=Array.from(o[e]);u[e]="number"===typeof t[0]?[t.reduce((function(e,t){return e+t}))/t.length]:Array.from(new Set(t))}));case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 5:return e.abrupt("return",t);case 6:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),J=function(){var e=Object(i.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j(t).then((function(e){var t=(null===e||void 0===e?void 0:e.state)||"";return F.current=t,t}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),z=function(){var e=Object(i.a)(s.a.mark((function e(t){var r,n,a,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M(t);case 2:return e.next=4,B(q,t);case 4:return r=e.sent,e.next=7,J(t);case 7:n=e.sent,a=I(t,{appState:r,bookmark:n},F),c=a.actions,a.provenance,null===t||void 0===t||t.on("dataSelected",function(){var e=Object(i.a)(s.a.mark((function e(r){var n,a,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=N(r),e.next=3,J(t);case 3:a=e.sent,o=function(){var e=Object(i.a)(s.a.mark((function e(){var r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B("object"===typeof(c=q)?JSON.parse(JSON.stringify(c)):c,t);case 2:return r=e.sent,console.log(r),e.abrupt("return",{newState:{bookmark:a,appState:r},label:n});case 5:case"end":return e.stop()}var c}),e)})));return function(){return e.apply(this,arguments)}}(),c.event(o);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),L=new v.service.Service(v.factories.hpmFactory,v.factories.wpmpFactory,v.factories.routerFactory),G="",V="",W=function(e){Object(f.a)(r,e);var t=Object(d.a)(r);function r(e){var n;return Object(p.a)(this,r),(n=t.call(this,e)).myReport=void 0,n.state={accessToken:"",embedUrl:"",error:[],reportRef:a.a.createRef(),reportLoaded:!1},n.myReport=null,n}return Object(l.a)(r,[{key:"render",value:function(){return this.myReport=this.renderMyReport(),a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{style:{display:"flex"}},a.a.createElement("div",{style:{display:"flex",flex:1}},a.a.createElement("div",{id:"reportContainer",ref:this.state.reportRef,style:{display:"flex",flexDirection:"column",flex:1}},"Loading the report..."))))}},{key:"componentDidMount",value:function(){var e=Object(i.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null!==this.state.reportRef&&(P=this.state.reportRef.current),this.authenticate();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"renderMyReport",value:function(){var e=null;if(this.state.error.length)P.textContent="",this.state.error.forEach((function(e){P.appendChild(document.createTextNode(e)),P.appendChild(document.createElement("br"))})),console.log("Error",this.state.error);else if(""!==this.state.accessToken&&""!==this.state.embedUrl){var t={type:"report",tokenType:v.models.TokenType.Aad,accessToken:G,embedUrl:V,permissions:v.models.Permissions.All,id:y,settings:{visualRenderedEvents:!0,panes:{filters:{visible:!0},pageNavigation:{visible:!0}}}};(e=L.embed(P,t)).off("loaded");e.on("loaded",(function(){console.log("Report load successful"),z(e)})),e.off("rendered"),e.on("rendered",(function(){})),e.off("error"),e.on("error",(function(e){var t=e.detail;console.error(t)}))}return e}},{key:"componentWillUnmount",value:function(){L.reset(P)}},{key:"authenticate",value:function(){var e=this,t=this,r={auth:{clientId:"1792bed2-974a-4310-9a61-aefe921dcb59"}},n={scopes:m},a=new h.a(r);a.handleRedirectCallback((function(e){"id_token"===e.tokenType?t.authenticate():"access_token"===e.tokenType?(G=e.accessToken,t.setUsername(e.account.name),t.getembedUrl()):t.setState({error:["Token type is: "+e.tokenType]})}),(function(e){t.setState({error:["Redirect error: "+e]})})),a.getAccount()?a.acquireTokenSilent(n).then((function(t){G=t.accessToken,e.setUsername(t.account.name),e.getembedUrl()})).catch((function(e){"InteractionRequiredAuthError"===e.name?a.acquireTokenRedirect(n):t.setState({error:[e.toString()]})})):a.loginRedirect(n)}},{key:"getembedUrl",value:function(){var e=this;fetch("https://api.powerbi.com/v1.0/myorg/groups/"+b+"/reports/"+y,{headers:{Authorization:"Bearer "+G},method:"GET"}).then((function(t){var r=[];r.push("Error occurred while fetching the embed URL of the report"),r.push("Request Id: "+t.headers.get("requestId")),t.json().then((function(n){t.ok?(V=n.embedUrl,e.setState({accessToken:G,embedUrl:V})):(r.push("Error "+t.status+": "+n.error.code),e.setState({error:r}))})).catch((function(){r.push("Error "+t.status+":  An error has occurred"),e.setState({error:r})}))})).catch((function(t){e.setState({error:t})}))}},{key:"setUsername",value:function(e){var t=document.getElementById("welcome");null!==t&&(t.innerText="Welcome, "+e)}}]),r}(a.a.Component);o.a.render(a.a.createElement(W,null),document.getElementById("root"))}},[[442,1,2]]]);
//# sourceMappingURL=main.1ae3a7bc.chunk.js.map